var expGuiCourseLight=function(pObject,config){var apiURL="http://api.ekispert.com/";var key;var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var s=scripts[i];imagePath=s.src.substring(0,s.src.indexOf("expGuiCourseLight\.js"));if(s.src&&s.src.match(/expGuiCourseLight\.js(\?.*)?/)){var params=s.src.replace(/.+\?/,'');params=params.split("&");for(var i=0;i<params.length;i++){var tmp=params[i].split("=");if(tmp[0]=="key"){key=unescape(tmp[1])}}break}}var searchObj;var resultObj;var result;var callbackFunction;function search(searchObject,callback){if(typeof searchObject=="string"){searchObj=createSearchInterface();var tmpParamList=searchObject.split('&');for(var i=0;i<tmpParamList.length;i++){var tmpParam=tmpParamList[i].split('=');if(tmpParam.length==2){switch(tmpParam[0].toLowerCase()){case"from":searchObj.setFrom(tmpParam[1]);break;case"to":searchObj.setTo(tmpParam[1]);break;case"via":searchObj.setVia(tmpParam[1]);break;case"date":searchObj.setDate(tmpParam[1]);break;case"time":searchObj.setTime(tmpParam[1]);break;case"searchtype":searchObj.setSearchType(tmpParam[1]);break;case"plane":searchObj.setPlane(tmpParam[1]);break;case"shinkansen":searchObj.setShinkansen(tmpParam[1]);break;case"limitedExpress":searchObj.setLimitedExpress(tmpParam[1]);break;case"bus":searchObj.setBus(tmpParam[1]);break}}}}else{searchObj=searchObject}var searchWord="";if(typeof searchObj.getFrom()!='undefined'){searchWord+="&from="+encodeURIComponent(searchObj.getFrom())}if(typeof searchObj.getTo()!='undefined'){searchWord+="&to="+encodeURIComponent(searchObj.getTo())}if(typeof searchObj.getVia()!='undefined'){searchWord+="&via="+encodeURIComponent(searchObj.getVia())}if(typeof searchObj.getDate()!='undefined'){searchWord+="&date="+searchObj.getDate()}if(typeof searchObj.getTime()!='undefined'){searchWord+="&time="+searchObj.getTime()}if(typeof searchObj.getSearchType()!='undefined'){searchWord+="&searchType="+searchObj.getSearchType()}if(typeof searchObj.getPlane()!='undefined'){searchWord+="&plane="+searchObj.getPlane()}if(typeof searchObj.getShinkansen()!='undefined'){searchWord+="&shinkansen="+searchObj.getShinkansen()}if(typeof searchObj.getLimitedExpress()!='undefined'){searchWord+="&limitedExpress="+searchObj.getLimitedExpress()}if(typeof searchObj.getBus()!='undefined'){searchWord+="&bus="+searchObj.getBus()}var url=apiURL+"v1/json/search/course/light?key="+key+"&"+searchWord;callbackFunction=callback;if(typeof resultObj!='undefined'){resultObj.abort()}var JSON_object={};if(window.XDomainRequest){resultObj=new XDomainRequest();resultObj.onload=function(){JSON_object=JSON.parse(resultObj.responseText);setRooteUrl(resultObj.responseText)};resultObj.onerror=function(){if(typeof callbackFunction=='function'){callbackFunction(false)}}}else{resultObj=new XMLHttpRequest();resultObj.onreadystatechange=function(){var done=4,ok=200;if(resultObj.readyState==done&&resultObj.status==ok){JSON_object=JSON.parse(resultObj.responseText);setRooteUrl(JSON_object)}else if(resultObj.readyState==done&&resultObj.status!=ok){if(typeof callbackFunction=='function'){callbackFunction(false)}}}}resultObj.open("GET",url,true);resultObj.send(null)}function setRooteUrl(requestObject){result=requestObject;if(typeof result.ResultSet.ResourceURI=='undefined'){if(typeof callbackFunction=='function'){callbackFunction(false)}}else{if(typeof callbackFunction=='function'){callbackFunction(true)}}}function setConfigure(name,value){if(name.toLowerCase()==String("apiURL").toLowerCase()){apiURL=value}}function createSearchInterface(){return new searchInterface()};function searchInterface(){var from;var to;var via;var date;var time;var searchType;var plane;var shinkansen;var limitedExpress;var bus;function setFrom(value){from=value};function getFrom(){return from};this.setFrom=setFrom;this.getFrom=getFrom;function setTo(value){to=value};function getTo(){return to};this.setTo=setTo;this.getTo=getTo;function setVia(value){via=value};function getVia(){return via};this.setVia=setVia;this.getVia=getVia;function setDate(value){date=value};function getDate(){return date};this.setDate=setDate;this.getDate=getDate;function setTime(value){time=value};function getTime(){return time};this.setTime=setTime;this.getTime=getTime;function setSearchType(value){searchType=value};function getSearchType(){return searchType};this.setSearchType=setSearchType;this.getSearchType=getSearchType;function setPlane(value){plane=value};function getPlane(){return plane};this.setPlane=setPlane;this.getPlane=getPlane;function setShinkansen(value){shinkansen=value};function getShinkansen(){return shinkansen};this.setShinkansen=setShinkansen;this.getShinkansen=getShinkansen;function setLimitedExpress(value){limitedExpress=value};function getLimitedExpress(){return limitedExpress};this.setLimitedExpress=setLimitedExpress;this.getLimitedExpress=getLimitedExpress;function setBus(value){bus=value};function getBus(){return bus};this.setBus=setBus;this.getBus=getBus};function getResourceURI(){if(typeof result!='undefined'){return result.ResultSet.ResourceURI}else{return}}this.search=search;this.createSearchInterface=createSearchInterface;this.setConfigure=setConfigure;this.getResourceURI=getResourceURI;this.SEARCHTYPE_DEPARTURE="departure";this.SEARCHTYPE_ARRIVAL="arrival";this.SEARCHTYPE_FIRSTTRAIN="firstTrain";this.SEARCHTYPE_LASTTRAIN="lastTrain";this.SEARCHTYPE_PLAIN="plain"};